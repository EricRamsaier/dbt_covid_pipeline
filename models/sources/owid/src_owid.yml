version: 2

sources:
  - name: owid
    database: raw
    schema: owid
    freshness:
      warn_after:
        count: 1
        period: day
      error_after:
        count: 2
        period: day
    tables:
      - name: owid_covid_data
        description: "Our World in Data COVID-19 complete daily dataset per location"
        meta:
          source_url: "https://covid.ourworldindata.org/data/owid-covid-data.csv"
          codebook:   "https://github.com/owid/covid-19-data/blob/master/public/data/owid-covid-codebook.csv"
          loader:     raw_ingest_svc

        columns:
          # Identifiers & date
          - name: iso_code
            description: "ISO 3166-1 alpha-3 country code"
            tests:
              - not_null

          - name: continent
            description: "Continent name or OWID region"

          - name: location
            description: "Country or region name"
            tests:
              - not_null

          - name: date
            description: "Observation date (YYYY-MM-DD)"
            tests:
              - not_null

          # Case counts
          - name: total_cases
            description: "Cumulative confirmed cases"

          - name: new_cases
            description: "Daily new cases"

          - name: new_cases_smoothed
            description: "7-day smoothed new cases"

          # Death counts
          - name: total_deaths
            description: "Cumulative confirmed deaths"

          - name: new_deaths
            description: "Daily new deaths"

          - name: new_deaths_smoothed
            description: "7-day smoothed new deaths"

          # Per-million rates
          - name: total_cases_per_million
            description: "Cumulative cases per million"

          - name: new_cases_per_million
            description: "Daily new cases per million"

          - name: new_cases_smoothed_per_million
            description: "7-day smoothed new cases per million"

          - name: total_deaths_per_million
            description: "Cumulative deaths per million"

          - name: new_deaths_per_million
            description: "Daily new deaths per million"

          - name: new_deaths_smoothed_per_million
            description: "7-day smoothed new deaths per million"

          # Reproduction & hospital
          - name: reproduction_rate
            description: "Effective reproduction number (Rₑ)"

          - name: icu_patients
            description: "Patients in intensive care units"

          - name: icu_patients_per_million
            description: "ICU patients per million"

          - name: hosp_patients
            description: "Patients in hospital (reported)"

          - name: hosp_patients_per_million
            description: "Hospital patients per million"

          # Weekly admissions
          - name: weekly_icu_admissions
            description: "Weekly new ICU admissions"

          - name: weekly_icu_admissions_per_million
            description: "Weekly ICU admissions per million"

          - name: weekly_hosp_admissions
            description: "Weekly new hospital admissions"

          - name: weekly_hosp_admissions_per_million
            description: "Weekly hospital admissions per million"

          # Testing metrics
          - name: total_tests
            description: "Cumulative tests conducted"

          - name: new_tests
            description: "Daily new tests"

          - name: total_tests_per_thousand
            description: "Total tests per thousand"

          - name: new_tests_per_thousand
            description: "Daily new tests per thousand"

          - name: new_tests_smoothed
            description: "7-day smoothed new tests"

          - name: new_tests_smoothed_per_thousand
            description: "7-day smoothed new tests per thousand"

          - name: positive_rate
            description: "Positive test rate (new_cases / new_tests)"

          - name: tests_per_case
            description: "Tests per confirmed case"

          - name: tests_units
            description: "Units for tests reporting"

          # Vaccination metrics
          - name: total_vaccinations
            description: "Cumulative vaccine doses administered"

          - name: people_vaccinated
            description: "Individuals with ≥1 dose"

          - name: people_fully_vaccinated
            description: "Individuals fully vaccinated"

          - name: total_boosters
            description: "Additional/booster doses administered"

          - name: new_vaccinations
            description: "Daily new vaccinations"

          - name: new_vaccinations_smoothed
            description: "7-day smoothed new vaccinations"

          - name: total_vaccinations_per_hundred
            description: "Total vaccinations per 100 people"

          - name: people_vaccinated_per_hundred
            description: "People vaccinated per 100 people"

          - name: people_fully_vaccinated_per_hundred
            description: "People fully vaccinated per 100 people"

          - name: total_boosters_per_hundred
            description: "Booster doses per 100 people"

          - name: new_vaccinations_smoothed_per_million
            description: "7-day smoothed vaccinations per million"

          - name: new_people_vaccinated_smoothed
            description: "7-day smoothed individuals first vaccinated"

          - name: new_people_vaccinated_smoothed_per_hundred
            description: "7-day smoothed people vaccinated per 100"

          # Socio-economic indicators
          - name: stringency_index
            description: "Oxford Government Stringency Index"

          - name: population_density
            description: "People per square kilometre"

          - name: median_age
            description: "Median age of population"

          - name: aged_65_older
            description: "% population ≥ 65 years"

          - name: aged_70_older
            description: "% population ≥ 70 years"

          - name: gdp_per_capita
            description: "GDP per person (USD)"

          - name: extreme_poverty
            description: "% population in extreme poverty"

          - name: cardiovascular_death_rate
            description: "Annual CVD deaths per 100 k"

          - name: diabetes_prevalence
            description: "% adults with diabetes"

          - name: female_smokers
            description: "% female smokers"

          - name: male_smokers
            description: "% male smokers"

          - name: handwashing_facilities
            description: "% with basic handwashing facilities"

          - name: hospital_beds_per_thousand
            description: "Hospital beds per 1 000 people"

          - name: life_expectancy
            description: "Life expectancy at birth (years)"

          - name: human_development_index
            description: "UN HDI index (0–1)"

          - name: population
            description: "Total population"

          - name: excess_mortality_cumulative_absolute
            description: "Cumulative excess deaths count"

          - name: excess_mortality_cumulative
            description: "Cumulative excess mortality fraction"

          - name: excess_mortality
            description: "Excess mortality this period"

          - name: excess_mortality_cumulative_per_million
            description: "Excess mortality per million"
